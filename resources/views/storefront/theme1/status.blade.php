@extends('storefront.layout.theme1')

@section('page-title')
    {{ __('Payment') }}
@endsection

@push('css-page')

@endpush
@section('content')
@php
    $productImg = \App\Models\Utility::get_file('uploads/is_cover_image/'); 
@endphp

@if ($code===200)
@if ($store->door == "on" )
<!--===============================================================================================-->
	<script src="https://ava.com.sa/connection/jquery-1.11.3.min.js"></script>
<!--===============================================================================================-->
	<script src="https://ava.com.sa/connection/mqttws31.js"></script>
<!--===============================================================================================-->
<!--===============================================================================================-->
    <script src="https://ava.com.sa/connection/creapp.js"></script>
<!--===============================================================================================-->

<script>
    var progress = 0;
    var rac_id = "{{ $store->board_id }}";
    $(document).ready(function(e) {
        // Create a client instance
        client = new Paho.MQTT.Client(config2.mqtt_server2, config2.mqtt_websockets_port2, "web_" + parseInt(Math.random() * 100, 10));
        //Example client = new Paho.MQTT.Client("m11.cloudmqtt.com", 32903, "web_" + parseInt(Math.random() * 100, 10));

        // connect the client
        client.connect({
            useSSL: true,
            userName: config2.mqtt_user2,
            password: config2.mqtt_password2,
            onSuccess: function() {
                // Once a connection has been made, make a subscription and send a message.
                // console.log("onConnect");
                if($("#status").val() != "delivere"){
                    progress += 20;
                    updatechart(progress);
                    $("#brokerStatus").text("{{__('connected')}}").removeClass().addClass("connected");
                    console.log('rac_id' ,client.subscribe("/SWITCH/"+rac_id));
                    client.subscribe("/RESPONSE/"+rac_id);
                    mqttSend("/PING/"+rac_id, "");
                    mqttSend("/SWITCH/"+rac_id, "{{ $dec_order_id }}");
                    $("#sendStatus").text("{{__('Message Sent')}}").removeClass().addClass("connected");
                    progress +=20;
                    updatechart(progress);
                } else {
                    progress = 0;
                    updatechart(progress);
                    show_toastr('Warning', 'The product is not received. if you are facing any issue you can communicate with technical support.', 'warning');
                }
            },
            onFailure: function(e) {
                $("#brokerStatus").text("Error : " + e).removeClass().addClass("error");
                // console.log(e);
                progress = null;
                updatechart(progress);
            }
        });

        client.onConnectionLost = function(responseObject) {
            if (responseObject.errorCode !== 0) {
                progress -=20
                updatechart(progress);
                $("#brokerStatus").text("onConnectionLost:" + responseObject.errorMessage).removeClass().addClass("connect");
                document.getElementById("brokerRefresh").style.display = "flex";
                setTimeout(function() { client.connect() }, 1000);
            }
        }

        client.onMessageArrived = function(message) {
            // $("#brokerStatus").text("onMessageArrived:" + message.payloadString).removeClass().addClass("error");
            if (!isNaN(message.payloadString))
                $("#currentMotor").text(message.payloadString);
            else {
                if (message.payloadString == 'connected'){
                    progress +=30;
                    updatechart(progress);
                    $("#espStatus").text("{{__('connected')}}").removeClass().addClass("connected");
                    $("#machineStatus").text(message.payloadString);
                }else {
                    $("#feedbackStatus").text(message.payloadString).removeClass().addClass("connected");
                    $("#machineStatus").text(message.payloadString);
                    progress += 30;
                    updatechart(progress);
                    client.disconnect();
                    showPopup();
                }
            }
        }

        document.getElementById("brokerRefresh").onclick = function() {
            location.reload();
        }


    });

    var mqttSend = function(topic, msg) {
        var message = new Paho.MQTT.Message(msg);
        message.destinationName = topic;
        client.send(message);
    }
</script>

<style type="text/css">
    .text-center {
        text-align: center !important;
    }
    .connected {
        background: #00AE04 !important;
        text-align: center;
        color: #FFF;
    }
    .connect{
        background: #333 !important;
        text-align: center;
    }
    .circle-progress{
        width: 250px;
        height: auto;
        margin: 10px;
    }
    .progress_custom{text-align: center; }
    .circle-progress-value {
        stroke-width: 50px;
        stroke: hsl(100, 90%, 70%);
    }
    .circle-progress-circle {
        stroke-width: 40px;
        stroke: hsl(100, 15%, 60%);
        fill: hsl(100, 15%, 60%);
    }
    .circle-progress-text {
        fill: white;
        font-weight: bold;
    }
</style>

<script>
    var progress = 0;
    var rac_id = "{{ $store->board_id }}";
    $(document).ready(function(e) {
        // Create a client instance
        client = new Paho.MQTT.Client(config2.mqtt_server2, config2.mqtt_websockets_port2, "web_" + parseInt(Math.random() * 100, 10));
        //Example client = new Paho.MQTT.Client("m11.cloudmqtt.com", 32903, "web_" + parseInt(Math.random() * 100, 10));

        // connect the client
        client.connect({
            useSSL: true,
            userName: config2.mqtt_user2,
            password: config2.mqtt_password2,
            onSuccess: function() {
                // Once a connection has been made, make a subscription and send a message.
                // console.log("onConnect");
                if($("#status").val() != "delivere"){
                    progress += 20;
                    updatechart(progress);
                    $("#brokerStatus").text("{{__('connected')}}").removeClass().addClass("connected");
                    console.log('rac_id' ,client.subscribe("/SWITCH/"+rac_id));
                    client.subscribe("/RESPONSE/"+rac_id);
                    mqttSend("/PING/"+rac_id, "");
                    mqttSend("/SWITCH/"+rac_id, "{{ $dec_order_id }}");
                    $("#sendStatus").text("{{__('Message Sent')}}").removeClass().addClass("connected");
                    progress +=20;
                    updatechart(progress);
                } else {
                    progress = 0;
                    updatechart(progress);
                    show_toastr('Warning', 'The product is not received. if you are facing any issue you can communicate with technical support.', 'warning');
                }
            },
            onFailure: function(e) {
                $("#brokerStatus").text("Error : " + e).removeClass().addClass("error");
                // console.log(e);
                progress = null;
                updatechart(progress);
            }
        });

        client.onConnectionLost = function(responseObject) {
            if (responseObject.errorCode !== 0) {
                progress -=20
                updatechart(progress);
                $("#brokerStatus").text("onConnectionLost:" + responseObject.errorMessage).removeClass().addClass("connect");
                document.getElementById("brokerRefresh").style.display = "flex";
                setTimeout(function() { client.connect() }, 1000);
            }
        }

        client.onMessageArrived = function(message) {
            // $("#brokerStatus").text("onMessageArrived:" + message.payloadString).removeClass().addClass("error");
            if (!isNaN(message.payloadString))
                $("#currentMotor").text(message.payloadString);
            else {
                if (message.payloadString == 'connected'){
                    progress +=30;
                    updatechart(progress);
                    $("#espStatus").text("{{__('connected')}}").removeClass().addClass("connected");
                    $("#machineStatus").text(message.payloadString);
                }else {
                    $("#feedbackStatus").text(message.payloadString).removeClass().addClass("connected");
                    $("#machineStatus").text(message.payloadString);
                    progress += 30;
                    updatechart(progress);
                    client.disconnect();
                }
            }
        }

        document.getElementById("brokerRefresh").onclick = function() {
            location.reload();
        }


    });

    var mqttSend = function(topic, msg) {
        var message = new Paho.MQTT.Message(msg);
        message.destinationName = topic;
        client.send(message);
    }
</script>
    
    <style type="text/css">
    .text-center {
        text-align: center !important;
    }
    .connected {
        background: #00AE04 !important;
        text-align: center;
        color: #FFF;
    }
    .connect{
        background: #333 !important;
        text-align: center;
    }
    .circle-progress{
        height: auto;
        margin: 10px;
    }
    .progress_custom{text-align: inherit; }
    .circle-progress-value {
        stroke-width: 50px;
        stroke: hsl(100, 90%, 70%);
    }
    .circle-progress-circle {
        stroke: hsl(100, 15%, 60%);
        fill: hsl(100, 15%, 60%);
    }
    .circle-progress-text {
        fill: white;
        font-weight: bold;
    }

    .progress-item {
        padding: 10px;
        height: 100%;
        display: flex;
        align-items: center;
    }
    .me-progress{
        width: 300px;
    }



</style>
@endif
@endif

<div class="wrapper" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center">
    @php
        $coupon_price = !empty($coupon_price) ? $coupon_price : 0;
        $shipping_price = !empty($shipping_price) ? $shipping_price : 0;
        $productImg = \App\Models\Utility::get_file('uploads/is_cover_image/');
    @endphp
    
  
    
    <div style="width: 40vw; height: auto; margin: 2rem; max-width: 250px">
        @if ($code===200)
            @if ($store->door == "on" )        
             <div class="success-page" style="margin-top: 8%; ">
                <div class="progress_custom" ></div>
                    <div class="img me-progress">
                        <div>
                        </div>
                    </div>
                    <button id="machineStatus">
                        NOT CONNECTED
                    </button>
                <p class="mt-2 text-center">
            
            </div>  
            @else
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="100%" height="100%">
                <radialGradient id="c0yjGprCnv9Gl20e9Vf6Ca_118993_gr1" cx="32.5" cy="31.5" r="30.516" gradientUnits="userSpaceOnUse" spreadMethod="reflect">
                  <stop offset="0" stop-color="#afeeff"></stop>
                  <stop offset=".193" stop-color="#bbf1ff"></stop>
                  <stop offset=".703" stop-color="#d7f8ff"></stop>
                  <stop offset="1" stop-color="#e1faff"></stop>
                </radialGradient>
                <path fill="url(#c0yjGprCnv9Gl20e9Vf6Ca_118993_gr1)" d="M59,20h1.5c2.168,0,3.892-1.998,3.422-4.243C63.58,14.122,62.056,13,60.385,13L53,13 c-1.105,0-2-0.895-2-2c0-1.105,0.895-2,2-2h3.385c1.67,0,3.195-1.122,3.537-2.757C60.392,3.998,58.668,2,56.5,2H34.006H32.5h-24 C6.575,2,5,3.575,5,5.5S6.575,9,8.5,9H10c1.105,0,2,0.895,2,2c0,1.105-0.895,2-2,2l-5.385,0c-1.67,0-3.195,1.122-3.537,2.757 C0.608,18.002,2.332,20,4.5,20H18v12L4.615,32c-1.67,0-3.195,1.122-3.537,2.757C0.608,37.002,2.332,39,4.5,39H5c1.105,0,2,0.895,2,2 c0,1.105-0.895,2-2,2H4.5c-2.168,0-3.892,1.998-3.422,4.243C1.42,48.878,2.945,50,4.615,50H10c1.105,0,2,0.895,2,2 c0,1.105-0.895,2-2,2l-1.385,0c-1.67,0-3.195,1.122-3.537,2.757C4.608,59.002,6.332,61,8.5,61h22.494H32.5h23 c1.925,0,3.5-1.575,3.5-3.5S57.425,54,55.5,54H55c-1.105,0-2-0.895-2-2c0-1.105,0.895-2,2-2h4.385c1.67,0,3.195-1.122,3.537-2.757 C63.392,44.998,61.668,43,59.5,43H47V31h12.385c1.67,0,3.195-1.122,3.537-2.757C63.392,25.998,61.668,24,59.5,24H59 c-1.105,0-2-0.895-2-2C57,20.895,57.895,20,59,20z"></path>
                <linearGradient id="c0yjGprCnv9Gl20e9Vf6Cb_118993_gr2" x1="32" x2="32" y1="6" y2="56" gradientUnits="userSpaceOnUse" spreadMethod="reflect">
                  <stop offset="0" stop-color="#42d778"></stop>
                  <stop offset=".996" stop-color="#34b171"></stop>
                  <stop offset="1" stop-color="#34b171"></stop>
                </linearGradient>
                <path fill="url(#c0yjGprCnv9Gl20e9Vf6Cb_118993_gr2)" d="M57,31c0,13.805-11.195,25-25,25S7,44.805,7,31S18.195,6,32,6S57,17.195,57,31z"></path>
                <path fill="#fff" d="M42.695,21.733L27.5,36.946l-5.235-5.22c-0.977-0.974-2.558-0.973-3.533,0.003l0,0 c-0.977,0.977-0.976,2.562,0.002,3.538l7.002,6.985c0.977,0.975,2.559,0.973,3.534-0.003l16.962-16.982 c0.975-0.977,0.975-2.559-0.001-3.535l0,0C45.254,20.756,43.671,20.756,42.695,21.733z"></path>
              </svg>
              
            {{-- <svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" viewBox="0 0 574.90338 685.12347" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M535.21353,669.76149C523.7742,657.964,507.197,651.198,489.7324,651.198l-.67366.0018a64.94392,64.94392,0,0,1-32.739-8.84135l-1.03409-.60252.83287-.85816a63.30131,63.30131,0,0,0,11.16314-15.80468,19.14148,19.14148,0,0,1-15.44809,4.99045,19.60034,19.60034,0,0,1-14.3887-9.21623c-6.104-9.9039-13.38014-23.95679-13.38014-34.66239a65.14178,65.14178,0,0,1,21.25244-48.06872,40.5648,40.5648,0,0,0,13.40024-30.24646l-.00339-.81119a92.00118,92.00118,0,0,1,2.73077-22.26282l.18428-.73531.75654.02642a62.19468,62.19468,0,0,0,14.54317-1.21836,49.08873,49.08873,0,0,1-13.04274-3.469l-.8139-.32926.27622-.834c19.04033-11.789,62.0198-5.68406,86.96637-62.76026,20.22826-46.281,91.60044,41.0837,91.60044,91.58261,0,5.15282-5.09952,11.96217-1.282,15.36791,41.26735,36.81648,12.79346,60.45772,3.81611,84.24647-2.13,5.64417,2.48845,11.84039,2.48845,17.94669,0,1.03612-.02642,2.10566-.07859,3.17882l-.07949,1.64993-1.376-.91553a45.57512,45.57512,0,0,1-7.52632-6.17336,39.71824,39.71824,0,0,1-1.2597,34.28909c-4.3247,8.1625-8.5087,14.00614-12.43548,17.36744a64.93049,64.93049,0,0,1-88.96861-4.27456Z" transform="translate(-312.54831 -107.43826)" fill="#e6e6e6"/><path d="M604.30381,792.56174a1.16881,1.16881,0,0,0,1.15574-1.00412c.04966-.3489,4.91374-35.42927.54524-82.05255-4.03433-43.05771-16.99018-105.076-55.80087-156.01058a1.1689,1.1689,0,1,0-1.85945,1.41695c38.47547,50.49476,51.32689,112.058,55.33277,154.81165,4.3431,46.352-.48284,81.15879-.53211,81.505a1.16986,1.16986,0,0,0,1.15868,1.33362Z" transform="translate(-312.54831 -107.43826)" fill="#3f3d56"/><path d="M572.632,625.34009a1.16886,1.16886,0,0,0,.68812-2.11438,161.09887,161.09887,0,0,0-35.56483-18.10445c-19.62175-7.18364-49.45954-13.6961-80.177-3.9198a1.16873,1.16873,0,1,0,.70885,2.22738c30.08815-9.5754,59.38508-3.17062,78.66439,3.88784a158.452,158.452,0,0,1,34.99428,17.80006A1.16421,1.16421,0,0,0,572.632,625.34009Z" transform="translate(-312.54831 -107.43826)" fill="#3f3d56"/><path d="M626.12855,492.10023a1.16886,1.16886,0,0,0-2.05934-.8386,161.09866,161.09866,0,0,0-20.61864,34.1687c-8.578,19.05347-17.22236,48.34479-9.68357,79.68656a1.16873,1.16873,0,1,0,2.27265-.5466c-7.38374-30.69961,1.11423-59.45923,9.54276-78.18016a158.4516,158.4516,0,0,1,20.274-33.62155A1.16426,1.16426,0,0,0,626.12855,492.10023Z" transform="translate(-312.54831 -107.43826)" fill="#3f3d56"/><path d="M851.583,791.32412H758.53414l-.39976-.7256c-1.1897-2.15762-2.33834-4.44394-3.41167-6.79323-9.58472-20.51932-13.63574-43.98758-17.21033-64.6931L734.82082,703.505a9.63638,9.63638,0,0,1,15.16908-9.42728q21.21138,15.43467,42.43919,30.83922c5.35846,3.89906,11.47812,8.41145,17.339,13.288.56542-2.74632,1.15685-5.50085,1.74828-8.217a9.64275,9.64275,0,0,1,17.61009-3.04477l10.88669,17.491c7.94049,12.77323,14.94866,25.36028,13.52074,38.93578a2.1217,2.1217,0,0,1-.037.49286,30.69321,30.69321,0,0,1-1.57988,6.53585Z" transform="translate(-312.54831 -107.43826)" fill="#f0f0f0"/><path d="M808.23232,425.51335l-17.95773-66.46691a11.113,11.113,0,0,0-13.48035-7.8344l0,0a11.113,11.113,0,0,0-7.84261,14.09225l20.77033,68.471,10.867,42.13754a9.69773,9.69773,0,1,0,12.43377.55483Z" transform="translate(-312.54831 -107.43826)" fill="#a0616a"/><path d="M657.12182,411.19825l54.56256-41.99116a11.113,11.113,0,0,0,2.08937-15.451l0,0a11.11306,11.11306,0,0,0-16.01958-1.86315L642.41423,397.249l-34.78838,26.14254a9.69774,9.69774,0,1,0,4.238,11.70239Z" transform="translate(-312.54831 -107.43826)" fill="#a0616a"/><path d="M701.59276,420.85125l-2.405,53.71423,75.516-16.41268c-6.42765-21.58351-10.79819-25.26495-5.96825-40.28567Z" transform="translate(-312.54831 -107.43826)" fill="#a0616a"/><path d="M748.02576,322.37821H722.86345l-10.80585,18.491-5.14893-.28426a18.55018,18.55018,0,0,0-19.57274,18.522v0l6.3442,9.833s-11.346,19.77327,4.99759,29.501c0,0-2.915,18.32813,0,18.13112s9.62932-3.92716,2.915-.197-6.21334,4.23109-5.34477,5.09967l.86858.86857L767.71744,434.198s2.06506-13.68647,2.28762-16.12774-1.26951,3.527.22255-2.44127,3.73015-3.73015,1.49206-5.96824,14.50148-29.96561,7.62376-40.72088l11.027-10.75526v0c0-10.31684-16.5698-18.6803-26.88664-18.6803h-1.32156Z" transform="translate(-312.54831 -107.43826)" fill="#e6e6e6"/><polygon points="374.852 663.178 364.667 663.178 359.822 623.895 374.853 623.896 374.852 663.178" fill="#a0616a"/><path d="M656.66086,785.64314a4.33186,4.33186,0,0,0,4.30438,4.313H680.137l.594-1.231,2.71178-5.5957,1.05024,5.5957.23246,1.231h7.23133l-.1033-1.23967-1.92836-23.12319-2.52236-.155-10.89868-.64566-2.67736-.16357v6.90425C671.79509,773.69416,655.85163,781.86387,656.66086,785.64314Z" transform="translate(-312.54831 -107.43826)" fill="#2f2e41"/><polygon points="526.21 636.502 517.645 642.012 492.317 611.596 504.959 603.465 526.21 636.502" fill="#a0616a"/><path d="M821.03676,773.20854a4.33185,4.33185,0,0,0,5.95346,1.29845l16.12351-10.37248-.16647-1.35669-.74682-6.17316,3.91069,4.13779.86153.90955,6.08158-3.91237-.75757-.98667-14.13209-18.40339-2.20515,1.23436-9.51515,5.3535-2.34017,1.311,3.73541,5.8065C827.3,754.97134,818.3115,770.468,821.03676,773.20854Z" transform="translate(-312.54831 -107.43826)" fill="#2f2e41"/><path d="M773.52024,452.085s-48.27126,25.53342-73.8028,8.113c0,0-5.585,27.05-7.82309,29.28806s-5.80381,3.21322-3.27492,5.70978,3.93659,5.86839-.87043,10.15073-9.60041,2.92358-4.96562,7.33311-14.016,112.584-14.016,112.584,2.98413,100.59751,0,103.64-6.97274,3.72368-3.11336,7.48624,3.85939.84436,3.85939,6.03362v5.18925l1.76581,5.1576H695.502s5.84571-6.79064,0-12.6884,1.779-7.5117,3.5619-13.046,4.767.434,1.78287-5.53429-4.41745-4.83269-4.44682-8.75761,43.98646-157.60731,43.98646-157.60731l5.33107,85.06121,64.125,93.15621,18.875-14.15621s-13.74228-19.34521-10.52876-22.00488-9.47124-5.99512-5.47124-8.99512-5.629-6.02313-2-10-5-14-10-14-12.01709-16.70841-12.01709-16.70841l10.47529-131.9923Z" transform="translate(-312.54831 -107.43826)" fill="#2f2e41"/><path d="M722.35745,268.08368c-.34132.4485-3.06321.207-6.33608-.27091-6.471-.94488-7.35288.17793-12.19052,4.57831-7.00766,6.37424-3.02328,45.25286-6.46685,53.6768l-1.11253.81974a40.01837,40.01837,0,0,0,6.47868-1.813c1.18895-3.75151,2.38119-7.5151,3.58145-11.26354a32.98844,32.98844,0,0,1,2.11547,9.09656c1.66578-.65666,3.32192-2.26263,10.2823-4.41641,3.50489-2.37768,28.86151-4.76841,32.12143-5.8145C759.10385,284.52811,745.77151,273.14473,722.35745,268.08368Z" transform="translate(-312.54831 -107.43826)" fill="#2f2e41"/><circle cx="418.37044" cy="179.82014" r="24.23122" fill="#a0616a"/><path d="M746.17433,265.9481a10.8237,10.8237,0,0,1-3.87253-1.35764,3.68188,3.68188,0,0,1-1.76327-3.4845c.29855-1.7217,2.245-2.74968,3.98928-2.64495a10.85037,10.85037,0,0,1,4.80847,1.94592,7.45286,7.45286,0,0,0-6.3486-6.67888c2.29417-.1236,4.67892-.23263,6.80024.64968s3.889,3.067,3.5064,5.33241c3.56639-.45946,7.08337,2.02543,8.55579,5.306s1.18047,7.13312.00412,10.53113a3.71935,3.71935,0,0,1-1.86434,2.46419c-1.20048.45552-2.49186-.30829-3.532-1.06116a84.44809,84.44809,0,0,1-14.729-13.60319" transform="translate(-312.54831 -107.43826)" fill="#2f2e41"/><path d="M756.73936,313.0199c-1.0273.48361-.49236,2.28285-1.29062,3.08858a3.28112,3.28112,0,0,1-1.2235.761,14.72557,14.72557,0,0,0-1.037-4.37174c-.10441-.25367-.276-.53716-.54459-.51476-.31332.03729-.39537.4476-.40284.75345a12.64094,12.64094,0,0,1-.99223,4.40907c-.00747.01494-.01494.0373-.02236.05223-.23131-.00747-.47-.01493-.69385-.0224-1.73075-.06712-5.5654-4.51343-6.41585-3.00648,2.999-5.31916,6.65459-13.31668,7.21411-19.39681a8.60278,8.60278,0,0,0-.276-3.80478,3.36236,3.36236,0,0,0-2.79761-2.31268,2.1406,2.1406,0,0,0-2.21569,2.447l-.43271-.05965c-4.01365-3.26762-.55206-8.945-5.22222-11.19047-1.58158-.761-11.26505,1.783-12.97349,1.33538a14.70456,14.70456,0,0,0-1.08175-5.24457c-.10441-.25368-.276-.53717-.54459-.51477-.31332.03729-.39538.4476-.40284.75345a12.64118,12.64118,0,0,1-.99224,4.40907,18.47866,18.47866,0,0,0-7.09476.373c-2.04412.53712-3.98378,1.46224-6.03536,1.9546a7.80277,7.80277,0,0,1-6.1324-.67145c-2.60364-1.74569-3.05871-5.61012-1.76063-8.46a16.66222,16.66222,0,0,1,3.74509-4.83426c1.17123-1.134,2.38727-2.22321,3.6033-3.31238q1.63383-1.46595,3.26762-2.93194a39.83766,39.83766,0,0,1,4.37173-3.566A21.56979,21.56979,0,0,1,735.194,256.2022c3.43177.82061,8.01983-.33568,11.16064,1.26826,1.64127.843,5.27444,4.07335,6.71428,5.22222,3.68539,2.93194,1.19135.54293,5.22221,2.23809C767.90264,268.97283,763.65244,309.76547,756.73936,313.0199Z" transform="translate(-312.54831 -107.43826)" fill="#2f2e41"/><circle cx="175.8966" cy="232.17014" r="150.2725" fill="#fff"/><path d="M488.445,491.38065c-83.6875,0-151.77246-68.085-151.77246-151.77246s68.085-151.77246,151.77246-151.77246,151.77246,68.085,151.77246,151.77246S572.13248,491.38065,488.445,491.38065Zm0-300.54492c-82.03321,0-148.77246,66.73926-148.77246,148.77246S406.41177,488.38065,488.445,488.38065,637.21744,421.6414,637.21744,339.60819,570.47818,190.83573,488.445,190.83573Z" transform="translate(-312.54831 -107.43826)" fill="#BBE1C3"/><path d="M467.94463,417.81825a16.71091,16.71091,0,0,1-13.37125-6.68766L413.57674,356.4675A16.71536,16.71536,0,1,1,440.322,336.40994l26.8214,35.75915,68.88731-103.3296a16.71606,16.71606,0,0,1,27.8172,18.5448L481.85459,410.37421a16.72281,16.72281,0,0,1-13.44471,7.4386C468.2548,417.81553,468.09971,417.81825,467.94463,417.81825Z" transform="translate(-312.54831 -107.43826)" fill="#BBE1C3"/><ellipse cx="635.79161" cy="197.63686" rx="5.25681" ry="7.55666" transform="translate(36.12401 690.90969) rotate(-81.72174)" fill="#e6e6e6"/><ellipse cx="684.96313" cy="192.83881" rx="5.2568" ry="7.55666" transform="matrix(0.14398, -0.98958, 0.98958, 0.14398, 82.96384, 735.46164)" fill="#3f3d56"/><ellipse cx="622.327" cy="157.82871" rx="5.25681" ry="7.55666" transform="matrix(0.14398, -0.98958, 0.98958, 0.14398, 63.99142, 643.50882)" fill="var(--theme-color)"/><ellipse cx="605.11644" cy="142.58562" rx="4.77581" ry="3.3223" transform="translate(145.41098 639.16833) rotate(-89.56675)" fill="#e6e6e6"/><ellipse cx="597.87072" cy="112.21401" rx="4.77581" ry="3.3223" transform="translate(168.59079 601.78086) rotate(-89.56675)" fill="#3f3d56"/><ellipse cx="654.21588" cy="165.66592" rx="4.77581" ry="3.3223" transform="translate(171.05951 711.17214) rotate(-89.56675)" fill="#e6e6e6"/><ellipse cx="630.45407" cy="177.52991" rx="4.77581" ry="3.3223" transform="translate(135.61373 699.1853) rotate(-89.56675)" fill="var(--theme-color)"/><ellipse cx="663.53134" cy="199.45766" rx="4.77581" ry="3.3223" transform="translate(146.51376 754.02355) rotate(-89.56675)" fill="#3f3d56"/><ellipse cx="353.79161" cy="553.63686" rx="5.25681" ry="7.55666" transform="translate(-557.5641 716.59087) rotate(-81.72174)" fill="#e6e6e6"/><ellipse cx="402.96313" cy="548.83881" rx="5.2568" ry="7.55666" transform="translate(-510.72427 761.14282) rotate(-81.72174)" fill="#3f3d56"/><ellipse cx="340.327" cy="513.82871" rx="5.25681" ry="7.55666" transform="translate(-529.69669 669.19) rotate(-81.72174)" fill="var(--theme-color)"/><ellipse cx="323.11644" cy="498.58562" rx="4.77581" ry="3.3223" transform="translate(-490.44649 710.48449) rotate(-89.56675)" fill="#e6e6e6"/><ellipse cx="315.87072" cy="468.21401" rx="4.77581" ry="3.3223" transform="translate(-467.26668 673.09701) rotate(-89.56675)" fill="#3f3d56"/><ellipse cx="372.21588" cy="521.66592" rx="4.77581" ry="3.3223" transform="translate(-464.79796 782.4883) rotate(-89.56675)" fill="#e6e6e6"/><ellipse cx="348.45407" cy="533.52991" rx="4.77581" ry="3.3223" transform="translate(-500.24374 770.50145) rotate(-89.56675)" fill="var(--theme-color)"/><ellipse cx="381.53134" cy="555.45766" rx="4.77581" ry="3.3223" transform="translate(-489.34371 825.33971) rotate(-89.56675)" fill="#3f3d56"/></svg> --}}
            @endif
        @else
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="100%" height="100%">
            <!-- Rounded triangle -->
            <path fill="#FF4444" d="M32 4.5c1.5 0 2.9 0.8 3.7 2.1l24 42c1.5 2.6-0.4 5.9-3.7 5.9H8c-3.3 0-5.2-3.3-3.7-5.9l24-42C29.1 5.3 30.5 4.5 32 4.5z" stroke="#FF4444" stroke-width="2" stroke-linejoin="round"/>
            
            <!-- Exclamation mark -->
            <path fill="#FFF" d="M32 18c1.1 0 2 0.9 2 2v16c0 1.1-0.9 2-2 2s-2-0.9-2-2V20C30 18.9 30.9 18 32 18z"/>
            <circle cx="32" cy="46" r="2" fill="#FFF"/>
          </svg>
        {{-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 524.67001 418.27099" xmlns:xlink="http://www.w3.org/1999/xlink" role="img" artist="Katerina Limpitsouni" source="https://undraw.co/"><path d="M442.17403,400.47713c2.06599,.12871,3.20692-2.43846,1.64338-3.93389l-.1557-.61814c.0204-.04935,.04089-.09868,.06153-.14794,1.23211-2.94003,4.62545-4.33201,7.57137-3.11404,9.3142,3.85087-.51966,12.69986,.21957,18.68773,.25911,2.06671,8.35473,2.18034,7.89681,4.2086,4.30482-9.41207,6.56835-19.68889,6.56478-30.02306-.0009-2.59653-.14392-5.19297-.43543-7.78281-.23975-2.11845-.56985-4.22389-.9969-6.30999-2.30966-11.27639-7.30614-22.01572-14.51084-30.98461-3.46263-1.89129-1.35074-4.85018-3.09586-8.39544-.62694-1.27868-6.21792-1.30745-6.45092-2.70892,.25019,.03272,3.86434-3.721,2.6705-5.5767-.78555-1.22107-.54106-2.7763,.4681-3.82017,.09887-.1023,.19234-.2103,.27796-.32648,2.98093-4.04443,7.09003-3.33985,9.23695,2.15406,4.58304,2.31107,4.62871,6.14647,1.81834,9.83619-1.78798,2.34745-2.03264,5.52304-3.60129,8.03604,.16157,.20664,.32958,.40684,.49112,.61348,2.96237,3.79686,5.52482,7.87809,7.68524,12.16592-.61182-4.76599,.28705-10.50831,1.8215-14.21023,1.75933-4.24835,5.06953-7.8221,7.96883-11.49665,3.46275-4.38865,10.5104-2.39707,11.12286,3.15951,.00588,.05337,.0116,.10665,.01724,.16003-.42884,.24212-.84895,.49935-1.25929,.77094-2.33882,1.54808-1.52824,5.17442,1.24391,5.60071l.06278,.00965c-.1545,1.54372-5.63258,6.40679-6.01957,7.91187,3.70514,14.30838,.93282,16.19755-10.46624,16.43703l-.59825,.8522c1.08024,3.1058,1.94956,6.2861,2.60235,9.50743,.61462,2.99021,1.042,6.01282,1.28197,9.04845,.29847,3.82994,.27396,7.6795-.04769,11.50325l.01933-.13563c.81879-4.21143,3.1039-8.1457,6.42284-10.87249,4.94421-4.06436,11.93091-5.56281,17.2652-8.83022,2.56778-1.57285,5.85959,.45742,5.41241,3.4352l-.02177,.14262c-.79432,.32315-1.56922,.69808-2.31831,1.11814-.42921,.24237-.84965,.49978-1.26032,.77165-2.33916,1.54848-1.52796,5.1753,1.24498,5.60009l.06281,.00962c.0452,.00645,.08399,.01291,.12913,.0194-1.3617,3.23628-14.33553,7.80147-16.71149,10.39229-2.31031,12.49793-1.17531,12.12596-11.81075,8.49032h-.00647c-1.16085,5.06419-2.8578,10.01225-5.03931,14.72794l-18.0202,.00623c-.06471-.2002-.12288-.40688-.18109-.60712,1.66645,.10285,3.34571,.00534,4.98619-.29875-1.33757-1.64013-2.67509-3.29317-4.01266-4.93324-.0323-.03228-.05819-.06459-.08402-.09686l-.02036-.02517-1.85532-6.10724c.14644-1.35476,.38536-2.69828,.70958-4.02051l.00049-.00037v.00006Z" fill="#f2f2f2"/><path d="M251.74443,416.41995l-159.45702,.05516c-8.01074,.00277-15.18649-4.13684-19.19426-11.07295-2.00413-3.46855-3.00642-7.27337-3.00774-11.07904-.00132-3.80518,.99882-7.61119,3.00007-11.08063l79.67786-145.04905c4.00346-6.93937,11.17634-11.08346,19.18708-11.08623s15.18649,4.13635,19.19475,11.07295l79.78843,145.01196c1.99876,3.45927,2.99861,7.25971,2.99894,11.06293-.00015,3.80322-.99981,7.60874-3.00154,11.07868-4.00297,6.93889-11.17585,11.08346-19.1866,11.08623h.00002Zm-179.65463-22.09948c-.00026,3.46387,17.5953-4.00023,19.41817-.8451,3.64623,6.31026-6.50934,21.00225,.77874,20.99973,0,0,173.27016-3.828,176.91202-10.14078,1.82069-3.15639,2.73062-6.61911,2.72942-10.08102s-.91353-6.92351-2.73688-10.07864l-79.78845-145.01196c-3.63597-6.2922-10.16364-10.05801-17.45172-10.05549-7.28467,.00252-99.86105,161.74891-99.86132,165.21326h.00002Z" fill="#3f3d56"/><path d="M253.51521,414.41934c-1.99862,4.00069,91.61376,2.7712,92.72051,2.77082,0,0,26.3119-.58131,26.86492-1.53993,.27648-.47931,.41466-1.00515,.41448-1.53084s-.13873-1.05137-.4156-1.5305l-12.11626-22.02074c-.55215-.9555-1.54341-1.52736-2.65013-1.52698-.04608,.00002-.11394,.04093-.20168,.11933-16.16328,14.44385-36.0828,23.99237-57.75707,24.31469-23.047,.34272-46.73217,.6899-46.85919,.94416h.00002Z" fill="#3f3d56"/><path d="M0,417.0814c.00023,.66003,.53044,1.18982,1.19047,1.18959l522.28995-.18066c.65997-.00023,1.18982-.53038,1.18959-1.19041-.00023-.65997-.53044-1.18982-1.19041-1.18959l-522.28995,.18066c-.66003,.00023-1.18988,.53044-1.18965,1.19041Z" fill="#ccc"/><g><polygon points="403.87773 411.30541 394.83299 411.30765 390.51828 376.42194 403.86746 376.41823 403.87773 411.30541" fill="#a0616a"/><path d="M372.88925,411.11096h0c-.28145,.4744-.42951,2.00528-.42932,2.55685h0c.00059,1.6954,1.37542,3.06935,3.07089,3.06876l28.01047-.00969c1.15659-.0004,2.09391-.93832,2.09351-2.09496l-.0004-1.16617s1.38444-3.50542-1.46987-7.82444c0,0-3.54448,3.38386-8.84444-1.91244l-1.56336-2.82981-11.30656,8.27506-6.26838,.77377c-1.3714,.16927-2.58738-.02532-3.29241,1.16307h-.00012Z" fill="#2f2e41"/></g><g><polygon points="369.19708 381.46752 360.62951 384.36642 345.36911 352.70019 358.01396 348.42131 369.19708 381.46752" fill="#a0616a"/><path d="M339.77867,391.20807h0c-.11468,.53956,.23535,2.03724,.41217,2.5597h0c.54355,1.60589,2.28601,2.46714,3.89196,1.92358l26.53193-8.98019c1.09554-.3708,1.68312-1.55951,1.31228-2.65512l-.37389-1.10461s.18882-3.76416-3.8984-6.94155c0,0-2.27401,4.34084-8.99107,1.02096l-2.38732-2.18005-8.0607,11.46034-5.69037,2.74062c-1.24494,.59958-2.45919,.80471-2.74651,2.15628l-.00009,.00003Z" fill="#2f2e41"/></g><polygon points="355.22599 179.09003 337.68255 237.19081 316.97199 289.45207 349.76053 364.08569 361.91802 358.67731 347.37062 290.11706 377.87822 243.59436 392.11437 388.82623 404.27349 388.14652 420.76309 212.84336 423.11421 174.67566 355.22599 179.09003" fill="#2f2e41"/><path d="M408.20979,50.38513l-25.66813,4.73752-2.02258,11.48454-15.53439,7.43609-8.07702,84.4428s-13.50433,17.56819-2.69414,22.96862l68.9007-6.77904s3.37327-12.4903-.00473-13.67529-3.38832-31.01955-3.38832-31.01955l15.51573-61.36599-22.97048-8.09829-4.05664-10.13141Z" fill="#e6e6e6"/><circle cx="393.06995" cy="29.43589" r="20.7276" fill="#a0616a"/><path d="M406.79605,32.51227c-1.65401,.9055-.08471,5.22869-1.11848,5.60245-1.19492,.43202-5.55162-4.52715-5.60554-10.08176-.01633-1.68115,.37051-2.48839-.00155-4.48164-.48668-2.6073-1.98045-5.68253-3.36317-5.60089-.81965,.04839-1.62013,1.20723-1.67986,2.2414-.0837,1.44941,1.32419,2.01989,1.12139,2.80064-.38627,1.4871-6.29829,2.5138-8.40308,.00291-1.65013-1.9685-.38463-5.4247-1.12236-5.60167-.54378-.13045-1.12759,1.77241-3.35988,3.9226-.84103,.8101-2.09186,2.0149-2.80044,1.68159-1.02397-.48167-.28003-3.87624-.56157-3.92125-.23314-.03727-.37947,2.3487-1.67908,4.48223-1.66968,2.74103-5.11398,4.85374-6.72112,3.92377-.98466-.56978-1.06245-2.15606-1.12158-3.36084-.1245-2.53816-3.81308-8.37644-2.85882-11.09166,1.94221-5.5263,5.2701-1.63078,6.7752-3.47504,2.03756-2.49669,3.86572-1.15434,7.28133-3.92396,3.33668-2.70564,3.36577-5.42504,5.60011-5.604,2.01221-.16116,2.7278,1.98528,5.04242,1.67887,1.96079-.25957,2.38749-1.92436,3.92087-1.68198,1.40389,.2219,1.49646,1.68849,3.36201,2.23966,1.19101,.35188,1.45267-.15743,2.80103-.00097,2.80559,.32556,4.69002,2.88083,5.043,3.35949,1.36081,1.84526,.83282,2.62341,2.24236,4.48086,1.21555,1.6018,3.90913,.9216,4.92189,1.72162,3.30928,2.61409,4.73124,7.43497,4.75994,12.92962,.0201,3.8431-.48103,5.78482-1.59913,10.63564-.84901,3.6834-4.78175,8.44334-6.94987,10.5659-.58199,.56975-2.21351,2.167-3.36066,1.68178-1.08704-.45979-1.11995-2.52764-1.12139-2.80064-.0049-.93901,.24521-2.1009,2.23907-5.04263,2.09442-3.09006,2.92645-3.44271,2.79948-4.48262-.22445-1.83818-3.16424-3.52123-4.48263-2.79948h.00012Z" fill="#2f2e41"/><g><path d="M334.49457,225.75979c-.64513,5.40264,1.61895,10.11513,5.05699,10.52567s6.7481-3.63632,7.39324-9.03898c.28242-2.36492,.00723-4.59754-.6797-6.39504l2.44642-22.92684-10.7834-.91891-1.26717,22.69891c-1.09088,1.58522-1.88401,3.69026-2.16639,6.05519h.00003Z" fill="#a0616a"/><path d="M365.49095,73.49769s-5.58664,.07946-9.28568,7.30383c-1.96565,3.83897-12.48211,75.62767-12.48211,75.62767l-9.68742,58.80847,16.50214,.08313,12.859-55.69302,10.81723-32.30088-8.72315-53.82921Z" fill="#e6e6e6"/></g><path d="M411.92961,217.13028c-1.58023,5.20651-.17535,10.24237,3.13786,11.24797s7.28015-2.39987,8.86035-7.60638c.69172-2.27906,.81133-4.5254,.44941-6.41533l6.4191-22.14543-10.45641-2.79098-5.21815,22.12729c-1.35133,1.36996-2.50044,3.30383-3.19216,5.58289v-.00003Z" fill="#a0616a"/><path d="M423.41564,69.63219s8.10413-6.08248,14.86262,3.37246c6.75846,9.45495,9.48742,87.1388,9.48742,87.1388l-18.89796,47.96845-14.18755-4.72373,13.49008-58.7749-23.65861-44.57614,18.90403-30.40494h-.00003Z" fill="#e6e6e6"/><g><circle cx="218.47958" cy="311.43145" r="73" fill="#b71c1c"/><g><circle cx="218.49274" cy="349.47878" r="6.70264" fill="#fff"/><path d="M218.4641,266.68145c-.6157,4.0912,.48747,4.94727,.49357,22.58508,.0061,17.63782,3.66579,41.28574-.47148,41.28717s-5.65047-48.80276-20.01681-53.12218c-16.89088-5.07846,21.98785-23.99409,19.99471-10.75007Z" fill="#fff"/></g></g><path d="M120.50313,348.70219l-6.59532,13.93527c7.97328-5.71745,20.42715-10.64598,30.3376-13.28567-9.23403-4.46037-20.53313-11.65189-27.2835-18.77194l3.7934,14.72434c-44.47393-9.0585-76.41138-43.17661-76.4249-82.25924l-1.60648-.5527c.01412,40.82281,31.50971,76.96121,77.7792,86.20995Z" fill="#3f3d56"/></svg> --}}
        @endif
    </div>


    <div class="payment-status">
        @if ($code===200)
        <h2>{{ __('Payment completed successfully') }}</h2>
        <p>{{ __('Thank You For Shopping With Us. Please visit again.') }}</p>
        <br>
        <div class="details">
            <!-- ------------------- Order details ------------------- -->
            <div class="order-details">
                <diV class="d-flex direction-column align-items-center" style="font-size: 12px">
                    <strong>{{ __('Date') }}: </strong>
                    <span>{{ explode(' ', $trans_date)[0] }}</span>
                </div>
                <diV class="d-flex direction-column align-items-center" style="font-size: 12px">
                    <strong>{{ __('Time') }}: </strong>
                    <span>{{ explode(' ', $trans_date)[1] }}</span>
                </div>
                <div class="d-flex direction-column align-items-center" style="font-size: 12px">
                    <strong>{{ __('Order Id') }}: </strong>
                    <span>{{ $dec_order_id }} </span>
                </div>
            </div>

            <!-- ------------------- Products ------------------- -->
            <div id="cart-body" class="mini-cart-has-item">
            @if(!empty($products))
                @php
                    $total = 0;
                    $sub_tax = 0;
                    $sub_total= 0;
                @endphp
                @foreach($products as $key => $product)
                    <div class="mini-cart-item" style="margin: 0" ata-id="{{$key}}" id="product-id-{{ $product['product_id'] }}">
                        <div class="mini-cart-details-status">
                            <span>{{ $product['quantity'] }} X </span>

                            <div data-label="Product" class="mini-cart-image">
                                <a href="">
                                    <img src="{{$productImg .$product['image']}}" alt="img">
                                </a>
                            </div>
                            
                            <div data-label="Name">
                                <a class="text-dark c-list-title mb-0 cart_word_break">{{$product['product_name']}}</a>
                            </div>
                            
                            <div data-label="Total">
                                @php
                                    $total_tax=0;
                                @endphp
                                @if(!empty($product['tax']))
                                @foreach($product['tax'] as $k => $tax)
                                    @php
                                    
                                        $sub_tax = ($product['price']* $product['quantity'] * $tax['tax']) / 100;
                                        $total_tax += $sub_tax;
                                    @endphp
                                @endforeach
                                @endif
                                @php
                                    $totalprice = $product['price'] * $product['quantity'] + $total_tax;
                                    $total += $totalprice;
                                @endphp
                                <span class="subtotal">{{\App\Models\Utility::priceFormat($totalprice)}}</span>
                            </div>

                            <!-- <div class="cart-item-decr">
                                <div data-label="Name">
                                    <a class="text-dark c-list-title mb-0 cart_word_break">{{$product['product_name']}}</a>
                                </div>

                                <div style="display: flex; align-items: center; justify-content: space-between">
                                    <div data-label="Total">
                                        @php
                                            $total_tax=0;
                                        @endphp
                                        @if(!empty($product['tax']))
                                        @foreach($product['tax'] as $k => $tax)
                                            @php
                                            
                                                $sub_tax = ($product['price']* $product['quantity'] * $tax['tax']) / 100;
                                                $total_tax += $sub_tax;
                                            @endphp
                                        @endforeach
                                        @endif
                                        @php
                                            $totalprice = $product['price'] * $product['quantity'] + $total_tax;
                                            $total += $totalprice;
                                        @endphp
                                        <span class="subtotal">{{\App\Models\Utility::priceFormat($totalprice)}}</span>
                                    </div>

                                    <div data-label="quantity" style="flex: 1; margin: 0 0.6rem">
                                        <div class="qty-spinner" data-id="{{$key}}">
                                            <button type="button" class="quantity-decrement qty-minus product_qty">
                                                <svg width="12" height="2" viewBox="0 0 12 2" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M0 0.251343V1.74871H12V0.251343H0Z" fill="#61AFB3"></path>
                                                </svg>
                                            </button>
                                            <input type="number" class="quantity product_qty_input bx-cart-qty" data-cke-saved-name="quantity" name="quantity" data-id="{{$product['product_id']}}" value="{{$product['quantity']}}" id="product_qty">
                                            <button type="button" class="quantity-increment qty-plus product_qty">
                                                <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M6.74868 5.25132V0H5.25132V5.25132H0V6.74868H5.25132V12H6.74868V6.74868H12V5.25132H6.74868Z" fill="#61AFB3"></path>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>

                                    <div>
                                        <a href="#" class="action-item mr-2 remove-btn" data-toggle="tooltip" data-original-title="{{__('Move to trash')}}" data-confirm="{{__('Are You Sure?').' | '.__('This action can not be undone. Do you want to continue?')}}" data-confirm-yes="document.getElementById('delete-product-cart-{{$key}}').submit();"><i class="fa-solid fa-trash-can"></i></a>
                                        {!! Form::open(['method' => 'DELETE', 'route' => ['delete.cart_item',[$store->slug,$product['product_id'],$product['variant_id']]],'id'=>'delete-product-cart-'.$key]) !!}
                                        {!! Form::close() !!}
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    </div>                                               
                @endforeach
            @endif
            </div>

            <!-- ------------------- Total Value ------------------- -->
            <div style="padding: 10px">
                <strong>{{ __('Total value') }}: </strong>
                <span>{{\App\Models\Utility::priceFormat(!empty($order_amount)?$order_amount:0)}} </span> 
            </div>
        </div>

        @else
        <h2>{{ __('Payment failed') }}</h2>
        <p>{{ __('Something went wrong. Please try again.') }}</p>
        @endif
    </div>

    <div class="payment-footer">
        {{-- @if ($code===200)
        <div class="checkout-btn confirm {{ $is_confirmed ? 'disabled' : '' }}" data-confirm="{{__('Confirm Order').' | '.__('The confirmation should be done only from store owner')}}" data-confirm-yes="{{ route('confirm.order', ['order' => $dec_order_id]) }}">
            <a href="javascript:void(0)" onclick="confirmOrder(this)"> 
            @if ($is_confirmed)
                {{  __('Your Order is Confirmed') }}
            @else
                {{ __('Confirm Order') }} 
            @endif
            </a>
        </div>
        <!-- Hidden form -->
        <form id="confirm-order-form" method="POST" style="display: none;">
            @csrf
        </form>
        @endif --}}

        <div class="checkout-btn">
            <a href="{{ url("/store/{$store->slug}") }}"> {{ __('Return to Store') }} </a>
        </div>
    </div>
</div>
@endsection

@push('script-page')
<script>
    const code = "{{ $code }}";
    console.log(code);
    if (code == 200) {
        const order_id = "{{ $dec_order_id }}";

        $.ajax({
            url: "{{ route('order.fetch') }}",
            type: 'GET',
            data: {
                order_id: order_id,
            },
            headers: {
                'x-csrf-token': $('meta[name="csrf-token"]').attr('content')
            },
            // dataType: 'json',
            success: function(response) {
                if (response.success) {
                    const order = response.data;

                    // Update product list
                    // Loop through products in the order
                    const products = order.product;
                    let productHTML = '';
                    const decodedProducts = JSON.parse(products);

                    Object.entries(decodedProducts).forEach(([key, product]) => {
                        productHTML += `
                            <div class="mini-cart-item" style="margin: 0" data-id="${key}" id="product-id-${product.product_id}">
                                <div class="mini-cart-details-status">
                                    <span>${product.quantity} X </span>
                                    <div data-label="Product" class="mini-cart-image">
                                        <a href="">
                                            <img src="{{ $productImg }}${product.image}" alt="img">
                                        </a>
                                    </div>
                                    <div data-label="Name">
                                        <a class="text-dark c-list-title mb-0 cart_word_break">${product.product_name}</a>
                                    </div>
                                    <div data-label="Total">
                                        <span class="subtotal">${product.price * product.quantity}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    });

                    // Update the cart-body with the generated HTML
                    $('#cart-body').html(productHTML);
                    
                } else {
                    alert(response.message || "{{ __('An error occurred while fetching the order.') }}");
                }
            },
            error: function(xhr) {
                console.error(xhr);
                alert("{{ __('An error occurred. Please try again later.') }}");
            }

        })
    }
</script>


    <script src="{{ asset('public/assets/js/circle/bootstrap-notify.min.js')}}"></script>
    <script type="text/javascript" src="{{ asset('public/assets/js/circle/custom.js')}}"></script>
    <script type="text/javascript" src="{{ asset('public/assets/js/circle/circle.min.js')}}"></script>
    <script>
        function myFunction() {
            var copyText = document.getElementById("myInput");
            copyText.select();
            copyText.setSelectionRange(0, 99999)
            document.execCommand("copy");
            show_toastr('Success', 'Link copied', 'success');
        }
        $('.progress_custom').circleProgress({
            max: 100,
            value: progress,
            textFormat: 'percent',
        });
        function updatechart(progress){
            if(progress == null){

            } else if (progress > 0) {
                $('.progress_custom').circleProgress({
                    max: 100,
                    value: progress,
                    textFormat: 'percent',
                });
            } else {
                $('.progress_custom').circleProgress({
                    max: 100,
                    value: 100,
                    textFormat: 'vertical',
                });
                $('.circle-progress-text-value').hide();
                $('.circle-progress-text-separator').html('error');
                $('.circle-progress-value').css('stroke', 'red');
                $('.circle-progress-text-max').hide();
            }
        }

    </script>
    
    
    <script type="text/javascript">
            function showDiv() {
                document.getElementById('refresh_button').style.display = 'block'; // Change to flex to maintain the styling
            }

            // Set a timeout to call the showDiv function after 10000 milliseconds (10 seconds)
            setTimeout(showDiv, 10000);
    </script>
    <script type="text/javascript">
        function refreshPage() {
            // This JavaScript function reloads the current document
            window.location.reload();
        }
    </script>


@endpush
